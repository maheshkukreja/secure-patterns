# Threat Model

| Asset | Threat | Baseline Controls | Mitigation Options | Risk |
|-------|--------|-------------------|-------------------|------|
| Cloud IAM role | Over-scoped binding: Trust policy uses wildcard or omits namespace condition, allowing any ServiceAccount in the cluster to assume the role | Trust policy exists | 1. Namespace + SA pinning: Always include both `namespace` and `serviceaccount` conditions in the trust policy<br>2. Policy-as-code: Use OPA / Gatekeeper or cloud IAM policy linting in CI to reject wildcard conditions<br>3. Audit: Periodically enumerate trust policies and flag any that lack namespace constraints | High |
| Cloud IAM role | Confused deputy (cross-namespace): Attacker creates a ServiceAccount with the same name in a different namespace and assumes the role | RBAC on SA creation | 1. Namespace binding: Include the namespace claim in the trust policy condition (not just the SA name)<br>2. Admission control: Restrict ServiceAccount creation in sensitive namespaces to specific principals<br>3. Drift Detection: Alert only on ServiceAccounts created manually (outside of CI/CD pipelines) in production namespaces | High |
| Projected token | Token theft from pod filesystem: Attacker with exec access reads `/var/run/secrets/tokens/` and replays the token from outside the cluster | Projected volumes | 1. Short TTL: Set `expirationSeconds` to the minimum your SDK supports (e.g., 15â€“30 min)<br>2. Network restriction: Cloud trust policy can include a source IP/VPC condition where supported<br>3. Detection: Alert on AssumeRoleWithWebIdentity calls from unexpected source IPs | Medium |
| Token audience | Audience misconfiguration: Token is issued with a broad or default audience, making it valid for unintended cloud trust policies | Projected volumes (which require an audience field) | 1. Explicit pinning: Always set the `audience` field in the projected volume to the exact STS endpoint (e.g., `sts.amazonaws.com`)<br>2. Validation: Admission webhook rejects pod specs where projected token audience is missing or set to a wildcard | Medium |
| OIDC issuer | Issuer spoofing: Attacker with `iam:CreateOpenIDConnectProvider` (or equivalent) access registers a rogue OIDC issuer URL in a cloud trust policy, issuing tokens that the cloud accepts | Cloud trust policy specifies issuer URL | 1. Issuer inventory: Maintain an allowlist of known OIDC issuer URLs per cloud account<br>2. Policy review: Flag trust policies that reference unrecognized issuer URLs<br>3. Access control: Restrict who can create or modify identity provider configurations in cloud IAM | Medium |
| IAM permissions | Blast radius: The cloud IAM role granted via federation has far more permissions than the workload needs | Role exists per workload | 1. Least privilege: Scope IAM policies to specific resources (ARNs, project IDs) and actions<br>2. Separate roles: One IAM role per workload, not per namespace or per cluster<br>3. Access Analyzer: Use cloud-native tools (IAM Access Analyzer, Policy Troubleshooter) to identify unused permissions | Low |
| Credential refresh | Revocation gap: Cached cloud credentials persist after a pod's ServiceAccount binding is changed during incident response, maintaining access until the session expires | Standard SDK behavior (auto-refresh based on TTL) | 1. Short session duration: Set the IAM role's max session duration to match the projected token TTL to shrink the revocation window<br>2. Pod restart: Terminate affected pods immediately after SA binding changes to force credential re-acquisition<br>3. Rotation testing: Include SA rebinding and credential expiry in integration tests | Low |
| Workload availability | OIDC issuer drift: Cluster upgrade or recreation changes the OIDC issuer URL or rotates signing keys, breaking all cloud trust policies silently | Managed OIDC endpoint | 1. Pre-flight check: Verify OIDC issuer URL stability before cluster operations<br>2. Integration test: Run STS exchange test in CI after cluster changes<br>3. Monitoring: Alert on STS authentication failure rate spikes | Medium |
